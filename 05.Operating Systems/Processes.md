# 프로세스의 정의

## 1. 프로세스의 정의
**프로세스(Process)** 란
> **실행 중인 프로그램에 커널이 부여한 실행 단위**다.

중요한 점은 "프로그램"과 "프로세스"는 다르다는 것이다.
- **프로그램**: 디스크에 저정된 정적인 실행 파일.
- **프로세스**: 그 프로그램이 **메모리 위에서 실행 중인 상태**

즉,
> 같은 프로그램이라도 여러 개의 프로세스로 동시에 실행될 수 있다.

  
## 2. 프로세스가 가지는 구성 요소

커널 관점에서 프로세스는 단순한 코드가 아니다. \
아래 모든 것을 포함한 **실행 컨텍스트(excution context)** 다.

### 1) 가상 주소 공간
각 프로세스는 **독립적인 가상 메모리 공간**을 가진다.

```mathematica
[ Text | Data | BSS | Heap | Stack ]
```

- 다른 프로세스의 메모리를 직접 접근할 수 없다.
- 이는 보호(Isolation)를 위한 OS의 핵심 기능이다.

### 2) CPU 실행 상태
프로세스는 다음 정보를 가진다.

- 프로그램 카운터 (PC)
- 스택 포인터 (SP)
- 일반 레지스터
- 플래그 레지스터

-> **컨텍스트 스위칭** 시 저장·복원된다.

### 3) 커널 관리 정보 (PCB)
Linux에서는 이를 `task_struct`로 표현한다.

포함 정보:
- PID, PPID
- 상태 (RUNNING, SLEEPING, ZOMBIE 등)
- 스케줄링 정보
- 파일 디스크립터 테이블
- 시그널 처리 정보
- UID, GID, capabilities

-> 프로세스 = user space + kernel space 메타데이터

## 3. 프로세스의 생성

### fork()
```c
pid_t pid = fork();
```
- 부모 프로세스를 **복제**하여 자식 프로세스 생성
- 반환값으로 부모/자식 구분

핵심 포인트:
- 주소 공간은 **논리적으로 복사**
- 실제 메모리는 **Copy-On-Write(COW)

---
### exec()
```c
execve("/bin/ls", argv, envp);
```
- 현재 프로세스의 **메모리 이미지 교체**
- PID는 유지된다
- 성공 시 돌아오지 않는다

fork는 "프로세스 생성", exec는 "프로그램 교체"

> fork: "너 하나 더" (프로세스 복제) \
exec: "이제부터 넌 이거야" (프로그램 교체) \
exec 성공 시: 이전 코드로 절대 돌아오지 않음 \
exec 실패 시: 원래 프로세스 상태 유지, 다음 줄 실행됨

## 4. 프로세스의 종료

### 정상 종료
- `return from main`
- `exit(status)`
- `_exit(status)`

### 비정상 종료
- 시그널 (SIGSEGV, SIGKILL 등)

#### 종료 후:
- 커널은 최소 정보 (PID, exit code)만 남김
- 부모가 `wait()` 해야 완전 제거

## 5. 프로세스 상태

대표적인 상태 전이:
```sql
READY -> RUNNING -> WATTING -> READY -> TERMINATED
```

Linux 내부 상태 :
- TASK_RUNNING
- TASK_INTERRUPTIBLE
- TASK_UNINTERRUPTIBLE
- TASK_STOPPED
- TASK_ZOMBIE

**좀비 프로세스**
- 실행은 끝났지만 부모가 수거하지 않은 상태
- 자원은 거의 없지만 PID는 점유

## 6. 프로세스와 스레드의 차이

| 구분 | 프로세스 | 스레드
|:---:|:---:|:---:|
|주소 공간 | 독립 | 공유|
| 생성 비용 | 큼| 작음
| 통신 | IPC 필요 | 메모리 공유|
|안정성 | 높음|낮음|

Linux에서 스레드는 `clone()`으로 만든 **특수한 프로세스**다.

## 7. 왜 프로세스가 중요한가
프로세스는 OS의 모든 자원 관리 기준이다.
- CPU 스케줄링 단위
- 메모리 보호 단위
- 파일·소켓 소유 주체
- 보안 권한 단위

**OS는 프로세스를 기준으로 나눈다**

## 8. TLPI 기준 정리
- 프로세스는 커널이 관리하는 실행 단위다.
- 각 프로세스는 독립된 가상 주소 공간을 가진다.
- fork는 프로세스를 복제하고, exec는 프로그램을 교체한다.
- 프로세스 종료 후 부모가 wait하지 않으면 좀비가 된다.
- Linux에서 스레드는 공유 자원이 많은 프로세스다.

